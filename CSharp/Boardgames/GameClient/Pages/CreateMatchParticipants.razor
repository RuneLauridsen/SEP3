@page "/creatematchparticipants/{matchid}"
@using GameClient.Data
@using GameClient.DTO
@using static GameClient.Data.Messages;
@inject IGameService GameService
@inject IAuthService AuthService

<PageTitle>Create match participants</PageTitle>

@code {
    [Parameter]
    public string MatchId { get; set; } = "";

    private int _matchId = 0;
    private Match _match = Match.Empty();

    protected override void OnInitialized() {
        _matchId = ParseUtil.ParseIntOrDefault(MatchId, 0);
        if (_matchId != 0) {
            var req = new GetMatchReq(_matchId, AuthService.GetJwt());
            var res = GameService.GetMatch(req);
            _match = res.match;
        }
    }

    private void OnCreateClicked(Game selectedGame) {
        try {
            var req = new CreateMatchRequest(AuthService.GetJwt(), selectedGame.GameId);
            var res = GameService.CreateMatch(req);

            res = res;


        } catch (NotAuthorizedException) {
            // TODO(rune): Error handling.
        }
    }

}
