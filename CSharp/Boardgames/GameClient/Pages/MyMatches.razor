@page "/mymatches"
@using GameClient.Data
@using GameClient.DTO
@using GameClient.Services
@using global::Shared.Data
@using static global::Shared.Data.Messages
@inject IGameService GameService
@inject NavigationManager navMgr

<PageTitle>Match</PageTitle>

<h1>Current matches</h1>

@foreach (var m in _matches) {
    <h3><a href="mymatches/@m.MatchId">ShowMatch id = @(m.MatchId)</a></h3>
}

@if (_errorReason != "") {
    <div class="alert alert-danger">@_errorReason</div>
}

@code {
    private IEnumerable<DTO.Match> _matches = Empty.Enumerable<DTO.Match>();
    private string _errorReason = "";

    protected override Task OnInitializedAsync() {
        Refresh();
        return base.OnInitializedAsync();
    }

    private void Refresh() {
        var req = new GetMyMatchesRequest();
        var res = GameService.GetMyMatches(req);
        _matches = res.matches;
    }
}
